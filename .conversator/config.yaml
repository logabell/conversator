version: "1"

# Root directory where projects are located/created
root_project_dir: /home/logabell/projects

# Conversator layer (subagents for planning/refinement)
# Uses OpenCode HTTP Serve API on port 4158
# Instance isolation: Uses OPENCODE_CONFIG_DIR to avoid conflicting with user's .opencode/
conversator:
  port: 4158
  # Version-controlled agent source (edit these to iterate on agents)
  agents_source: conversator/agents
  # Runtime location (copied from source at startup, gitignored)
  agents_runtime: .conversator/opencode/agent
  # OpenCode config directory (isolated from user's .opencode/)
  opencode_config_dir: .conversator/opencode

# Voice interface
voice:
  provider: gemini-live
  model: gemini-2.0-flash-exp
  system_prompt: .conversator/prompts/conversator.md
  api_key_env: GOOGLE_API_KEY

# Builder agents - external coding CLI agents that receive final prompts
builders:
  # Claude Code via SDK (when available)
  claude-code:
    type: claude-code-sdk
    modes:
      plan: opus      # Deep planning
      build: sonnet   # Implementation
    worktree_prefix: claude-wt-

  # Generic OpenCode builder (user's external instance for development)
  opencode:
    type: opencode
    port: 4096
    worktree_prefix: oc-wt-

# Automatic routing rules (when user doesn't specify)
routing:
  default: opencode
  rules:
    - match: { complexity: high }
      agent: claude-code
      mode: plan
    - match: { type: security }
      agent: claude-code
    - match: { type: refactor, scope: large }
      agent: claude-code
      mode: plan

# Subagent models (used by Conversator layer)
models:
  planner: opencode/gemini-3-flash
  summarizer: opencode/gemini-3-flash
  context_reader: opencode/gemini-3-flash

# Token budgets
budgets:
  voice_context_tokens: 900
  subagent_context_tokens: 4000

# Task orchestration
orchestration:
  # Primary: Beads CLI for task queue
  primary: beads
  # Alternative: vibe-kanban for visual task board
  fallback: vibe-kanban
